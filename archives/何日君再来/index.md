---
title: CCBC 1314解题报告/何日君再来
date: 2024-08-16
dates:
---

<div>队伍：该队伍已注销<br>
报告：piscesciurus</div>

<figure>
<blockquote>
<p>不要取关！会有何日君再来！
</blockquote>
<figcaption>CCBC 15成就</figcaption>
</figure>

《何日君再来》这道题目严格说来不需要编程求解，但它以程序的方式呈现，其中涉及到的诸多概念来自离散数学和自动机理论。不做完小题答案更是无法爆破得到最终答案，吓跑了很多选手。它在赛后问卷评分中仅次于传奇SG函数题《奇怪的游戏》，与《五彩斑斓的黑白》并列倒数第二。

不过，作为后排队伍，有充足的信用点的话，甚至可以直接购买本题的所有提示，立即通过本题。

## 何日君再来

<div>解题：piscesciurus</div>

> 解题过程不需要阅读以下代码

```ruby

```

题目给出了一个Ruby程序，需要选手运行，运行结果为又一个Ruby程序，类似自我生成程序（quine），但产生的程序与原程序有细微不同，这同时体现在注释和代码中。上述程序的运行结果如下：

```ruby

```

正常的解法是运行程序，观察源代码与输出结果的不同之处，推断出每小题的变化规律。但是……

**让我访问！**

我把混淆拆解了。

本题充分利用了Ruby语法的混沌。[哈哈哈，其他语言做得到吗？](https://prts.wiki/w/%E6%8B%89%E6%99%AE%E5%85%B0%E5%BE%B7/%E8%AF%AD%E9%9F%B3%E8%AE%B0%E5%BD%95)


首先把%w~~括起的字符串$s拆开
得到d、f、g三个%q!!括起的字符串
d是当前状态
f是状态转移函数
g是输出用子程序
cs为压缩+编码的λ
ds为解码+解压的λ
因此只要读出f程序就能立即知道规律
f首先执行了下列语句
s = Marshal.load(ds.(d))
从外层作用域中读取了状态d
然后进行右列中的计算
具体算法在右列中说明
这样就完全跳过了观察和猜测

